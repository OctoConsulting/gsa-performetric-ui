import { Injectable } from '@angular/core';
import * as i0 from "@angular/core";
export class SdsAdvancedFiltersService {
    constructor() { }
    convertToCheckboxes(origFields) {
        const fields = [];
        origFields.forEach(origField => {
            if (origField.fieldGroup && origField.fieldGroup.length > 1) {
                const field = this.createMulticheckbox(origField);
                fields.push(field);
            }
            else {
                const field = {
                    type: 'checkbox',
                    key: origField.key,
                    defaultValue: !origField.hide,
                    templateOptions: {
                        hideOptional: true
                    }
                };
                if (origField.templateOptions && origField.templateOptions.label) {
                    field.templateOptions.label = origField.templateOptions.label;
                }
                fields.push(field);
            }
        });
        return fields;
    }
    // TODO: Should be changed so option has label field instead of key but multicheckbox field type must be updated so default value still works
    createMulticheckbox(origField) {
        const options = [];
        const defaultValue = [];
        origField.fieldGroup.forEach(field => {
            const label = field.templateOptions && field.templateOptions.label ? field.templateOptions.label : null;
            const option = {
                key: field.key,
                value: label
            };
            options.push(option);
            if (!origField.hide && !field.hide) {
                defaultValue.push(field.key);
            }
        });
        const field = {
            key: origField.key,
            type: 'multicheckbox',
            templateOptions: {
                hideOptional: true,
                type: 'array',
                options: options
            }
        };
        if (origField.templateOptions && origField.templateOptions.label) {
            field.templateOptions.label = origField.templateOptions.label;
        }
        if (!origField.hide) {
            field.defaultValue = defaultValue;
        }
        return field;
    }
    updateFields(selectedFields, fields, model) {
        fields.forEach((field) => {
            const key = field.key;
            const selectedField = selectedFields[key];
            if (field.fieldGroup && field.fieldGroup.length > 1) {
                const fieldModel = model[key];
                this.updateFieldGroup(field, selectedField, fieldModel);
            }
            else {
                this.updateSingleField(field, selectedField, model);
            }
        });
        return {
            fields: fields,
            model: model
        };
    }
    updateFieldGroup(parentField, selectedFields, model) {
        if (selectedFields && selectedFields.length) {
            parentField.hide = false;
            parentField.fieldGroup.forEach(field => {
                const key = field.key;
                const fieldSelected = selectedFields.includes(key);
                this.updateSingleField(field, fieldSelected, model);
            });
        }
        else {
            parentField.hide = true;
            parentField.fieldGroup.forEach(field => {
                this.updateSingleField(field, false, model);
            });
        }
    }
    updateSingleField(field, fieldSelected, model) {
        if (fieldSelected) {
            field.hide = false;
        }
        else {
            field.hide = true;
            field.templateOptions['required'] = false;
            model[field.key] = null;
        }
    }
}
SdsAdvancedFiltersService.decorators = [
    { type: Injectable, args: [{
                providedIn: 'root'
            },] }
];
/** @nocollapse */
SdsAdvancedFiltersService.ctorParameters = () => [];
SdsAdvancedFiltersService.ngInjectableDef = i0.defineInjectable({ factory: function SdsAdvancedFiltersService_Factory() { return new SdsAdvancedFiltersService(); }, token: SdsAdvancedFiltersService, providedIn: "root" });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2RzLWFkdmFuY2VkLWZpbHRlcnMuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0Bnc2Etc2FtL3NhbS1mb3JtbHkvIiwic291cmNlcyI6WyJsaWIvZm9ybWx5LWZpbHRlcnMvYWR2YW5jZWQtZmlsdGVycy9zZHMtYWR2YW5jZWQtZmlsdGVycy5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7O0FBTzNDLE1BQU0sT0FBTyx5QkFBeUI7SUFFcEMsZ0JBQWUsQ0FBQztJQUVoQixtQkFBbUIsQ0FBQyxVQUErQjtRQUNqRCxNQUFNLE1BQU0sR0FBd0IsRUFBRSxDQUFDO1FBQ3ZDLFVBQVUsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLEVBQUU7WUFDN0IsSUFBSSxTQUFTLENBQUMsVUFBVSxJQUFJLFNBQVMsQ0FBQyxVQUFVLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtnQkFDM0QsTUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLG1CQUFtQixDQUFDLFNBQVMsQ0FBQyxDQUFDO2dCQUNsRCxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO2FBQ3BCO2lCQUFNO2dCQUNMLE1BQU0sS0FBSyxHQUFzQjtvQkFDL0IsSUFBSSxFQUFFLFVBQVU7b0JBQ2hCLEdBQUcsRUFBRSxTQUFTLENBQUMsR0FBRztvQkFDbEIsWUFBWSxFQUFFLENBQUMsU0FBUyxDQUFDLElBQUk7b0JBQzdCLGVBQWUsRUFBRTt3QkFDZixZQUFZLEVBQUUsSUFBSTtxQkFDbkI7aUJBQ0YsQ0FBQztnQkFFRixJQUFJLFNBQVMsQ0FBQyxlQUFlLElBQUksU0FBUyxDQUFDLGVBQWUsQ0FBQyxLQUFLLEVBQUU7b0JBQ2hFLEtBQUssQ0FBQyxlQUFlLENBQUMsS0FBSyxHQUFHLFNBQVMsQ0FBQyxlQUFlLENBQUMsS0FBSyxDQUFDO2lCQUMvRDtnQkFDRCxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FB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QUFHLENBQUMsQ0FBQztnQkFDbkQsSUFBSSxDQUFDLGlCQUFpQixDQUFDLEtBQUssRUFBRSxhQUFhLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDdEQsQ0FBQyxDQUFDLENBQUM7U0FDSjthQUFNO1lBQ0wsV0FBVyxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7WUFDeEIsV0FBVyxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUU7Z0JBQ3JDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQzlDLENBQUMsQ0FBQyxDQUFDO1NBQ0o7SUFDSCxDQUFDO0lBRUQsaUJBQWlCLENBQ2YsS0FBd0IsRUFDeEIsYUFBc0IsRUFDdEIsS0FBVTtRQUVWLElBQUksYUFBYSxFQUFFO1lBQ2pCLEtBQUssQ0FBQyxJQUFJLEdBQUcsS0FBSyxDQUFDO1NBQ3BCO2FBQU07WUFDTCxLQUFLLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztZQUNsQixLQUFLLENBQUMsZUFBZSxDQUFDLFVBQVUsQ0FBQyxHQUFHLEtBQUssQ0FBQztZQUMxQyxLQUFLLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQztTQUN6QjtJQUNILENBQUM7OztZQWxIRixVQUFVLFNBQUM7Z0JBQ1YsVUFBVSxFQUFFLE1BQU07YUFDbkIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBGb3JtbHlGaWVsZENvbmZpZyB9IGZyb20gJ0BuZ3gtZm9ybWx5L2NvcmUnO1xuXG5ASW5qZWN0YWJsZSh7XG4gIHByb3ZpZGVkSW46ICdyb290J1xufSlcblxuZXhwb3J0IGNsYXNzIFNkc0FkdmFuY2VkRmlsdGVyc1NlcnZpY2Uge1xuXG4gIGNvbnN0cnVjdG9yKCkge31cblxuICBjb252ZXJ0VG9DaGVja2JveGVzKG9yaWdGaWVsZHM6IEZvcm1seUZpZWxkQ29uZmlnW10pOiBGb3JtbHlGaWVsZENvbmZpZ1tdIHtcbiAgICBjb25zdCBmaWVsZHM6IEZvcm1seUZpZWxkQ29uZmlnW10gPSBbXTtcbiAgICBvcmlnRmllbGRzLmZvckVhY2gob3JpZ0ZpZWxkID0+IHtcbiAgICAgIGlmIChvcmlnRmllbGQuZmllbGRHcm91cCAmJiBvcmlnRmllbGQuZmllbGRHcm91cC5sZW5ndGggPiAxKSB7XG4gICAgICAgIGNvbnN0IGZpZWxkID0gdGhpcy5jcmVhdGVNdWx0aWNoZWNrYm94KG9yaWdGaWVsZCk7XG4gICAgICAgIGZpZWxkcy5wdXNoKGZpZWxkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGZpZWxkOiBGb3JtbHlGaWVsZENvbmZpZyA9IHtcbiAgICAgICAgICB0eXBlOiAnY2hlY2tib3gnLFxuICAgICAgICAgIGtleTogb3JpZ0ZpZWxkLmtleSxcbiAgICAgICAgICBkZWZhdWx0VmFsdWU6ICFvcmlnRmllbGQuaGlkZSxcbiAgICAgICAgICB0ZW1wbGF0ZU9wdGlvbnM6IHtcbiAgICAgICAgICAgIGhpZGVPcHRpb25hbDogdHJ1ZVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBpZiAob3JpZ0ZpZWxkLnRlbXBsYXRlT3B0aW9ucyAmJiBvcmlnRmllbGQudGVtcGxhdGVPcHRpb25zLmxhYmVsKSB7XG4gICAgICAgICAgZmllbGQudGVtcGxhdGVPcHRpb25zLmxhYmVsID0gb3JpZ0ZpZWxkLnRlbXBsYXRlT3B0aW9ucy5sYWJlbDtcbiAgICAgICAgfVxuICAgICAgICBmaWVsZHMucHVzaChmaWVsZCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGZpZWxkcztcbiAgfVxuXG4gIC8vIFRPRE86IFNob3VsZCBiZSBjaGFuZ2VkIHNvIG9wdGlvbiBoYXMgbGFiZWwgZmllbGQgaW5zdGVhZCBvZiBrZXkgYnV0IG11bHRpY2hlY2tib3ggZmllbGQgdHlwZSBtdXN0IGJlIHVwZGF0ZWQgc28gZGVmYXVsdCB2YWx1ZSBzdGlsbCB3b3Jrc1xuICBjcmVhdGVNdWx0aWNoZWNrYm94KG9yaWdGaWVsZDogRm9ybWx5RmllbGRDb25maWcpOiBGb3JtbHlGaWVsZENvbmZpZyB7XG4gICAgY29uc3Qgb3B0aW9ucyA9IFtdO1xuICAgIGNvbnN0IGRlZmF1bHRWYWx1ZSA9IFtdO1xuICAgIG9yaWdGaWVsZC5maWVsZEdyb3VwLmZvckVhY2goZmllbGQgPT4ge1xuICAgICAgY29uc3QgbGFiZWwgPSBmaWVsZC50ZW1wbGF0ZU9wdGlvbnMgJiYgZmllbGQudGVtcGxhdGVPcHRpb25zLmxhYmVsID8gZmllbGQudGVtcGxhdGVPcHRpb25zLmxhYmVsIDogbnVsbDtcbiAgICAgIGNvbnN0IG9wdGlvbiA9IHtcbiAgICAgICAga2V5OiBmaWVsZC5rZXksXG4gICAgICAgIHZhbHVlOiBsYWJlbFxuICAgICAgfTtcbiAgICAgIG9wdGlvbnMucHVzaChvcHRpb24pO1xuICAgICAgaWYgKCFvcmlnRmllbGQuaGlkZSAmJiAhZmllbGQuaGlkZSkge1xuICAgICAgICBkZWZhdWx0VmFsdWUucHVzaChmaWVsZC5rZXkpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3QgZmllbGQ6IEZvcm1seUZpZWxkQ29uZmlnID0ge1xuICAgICAga2V5OiBvcmlnRmllbGQua2V5LFxuICAgICAgdHlwZTogJ211bHRpY2hlY2tib3gnLFxuICAgICAgdGVtcGxhdGVPcHRpb25zOiB7XG4gICAgICAgIGhpZGVPcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgdHlwZTogJ2FycmF5JyxcbiAgICAgICAgb3B0aW9uczogb3B0aW9uc1xuICAgICAgfVxuICAgIH07XG5cbiAgICBpZiAob3JpZ0ZpZWxkLnRlbXBsYXRlT3B0aW9ucyAmJiBvcmlnRmllbGQudGVtcGxhdGVPcHRpb25zLmxhYmVsKSB7XG4gICAgICBmaWVsZC50ZW1wbGF0ZU9wdGlvbnMubGFiZWwgPSBvcmlnRmllbGQudGVtcGxhdGVPcHRpb25zLmxhYmVsO1xuICAgIH1cblxuICAgIGlmICghb3JpZ0ZpZWxkLmhpZGUpIHtcbiAgICAgIGZpZWxkLmRlZmF1bHRWYWx1ZSA9IGRlZmF1bHRWYWx1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZpZWxkO1xuICB9XG5cbiAgdXBkYXRlRmllbGRzKCBzZWxlY3RlZEZpZWxkczogb2JqZWN0LCBmaWVsZHM6IEZvcm1seUZpZWxkQ29uZmlnW10sIG1vZGVsOiBhbnkpIHtcbiAgICBmaWVsZHMuZm9yRWFjaCgoZmllbGQ6IEZvcm1seUZpZWxkQ29uZmlnKSA9PiB7XG4gICAgICBjb25zdCBrZXkgPSBmaWVsZC5rZXk7XG4gICAgICBjb25zdCBzZWxlY3RlZEZpZWxkID0gc2VsZWN0ZWRGaWVsZHNba2V5XTtcbiAgICAgIGlmIChmaWVsZC5maWVsZEdyb3VwICYmIGZpZWxkLmZpZWxkR3JvdXAubGVuZ3RoID4gMSkge1xuICAgICAgICBjb25zdCBmaWVsZE1vZGVsID0gbW9kZWxba2V5XTtcbiAgICAgICAgdGhpcy51cGRhdGVGaWVsZEdyb3VwKGZpZWxkLCBzZWxlY3RlZEZpZWxkLCBmaWVsZE1vZGVsKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMudXBkYXRlU2luZ2xlRmllbGQoZmllbGQsIHNlbGVjdGVkRmllbGQsIG1vZGVsKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4ge1xuICAgICAgZmllbGRzOiBmaWVsZHMsXG4gICAgICBtb2RlbDogbW9kZWxcbiAgICB9O1xuICB9XG5cbiAgdXBkYXRlRmllbGRHcm91cCggcGFyZW50RmllbGQ6IEZvcm1seUZpZWxkQ29uZmlnLCBzZWxlY3RlZEZpZWxkczogYW55LCBtb2RlbDogb2JqZWN0KSB7XG4gICAgaWYgKHNlbGVjdGVkRmllbGRzICYmIHNlbGVjdGVkRmllbGRzLmxlbmd0aCkge1xuICAgICAgcGFyZW50RmllbGQuaGlkZSA9IGZhbHNlO1xuICAgICAgcGFyZW50RmllbGQuZmllbGRHcm91cC5mb3JFYWNoKGZpZWxkID0+IHtcbiAgICAgICAgY29uc3Qga2V5ID0gZmllbGQua2V5O1xuICAgICAgICBjb25zdCBmaWVsZFNlbGVjdGVkID0gc2VsZWN0ZWRGaWVsZHMuaW5jbHVkZXMoa2V5KTtcbiAgICAgICAgdGhpcy51cGRhdGVTaW5nbGVGaWVsZChmaWVsZCwgZmllbGRTZWxlY3RlZCwgbW9kZWwpO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHBhcmVudEZpZWxkLmhpZGUgPSB0cnVlO1xuICAgICAgcGFyZW50RmllbGQuZmllbGRHcm91cC5mb3JFYWNoKGZpZWxkID0+IHtcbiAgICAgICAgdGhpcy51cGRhdGVTaW5nbGVGaWVsZChmaWVsZCwgZmFsc2UsIG1vZGVsKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHVwZGF0ZVNpbmdsZUZpZWxkKFxuICAgIGZpZWxkOiBGb3JtbHlGaWVsZENvbmZpZyxcbiAgICBmaWVsZFNlbGVjdGVkOiBib29sZWFuLFxuICAgIG1vZGVsOiBhbnlcbiAgKSB7XG4gICAgaWYgKGZpZWxkU2VsZWN0ZWQpIHtcbiAgICAgIGZpZWxkLmhpZGUgPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgZmllbGQuaGlkZSA9IHRydWU7XG4gICAgICBmaWVsZC50ZW1wbGF0ZU9wdGlvbnNbJ3JlcXVpcmVkJ10gPSBmYWxzZTtcbiAgICAgIG1vZGVsW2ZpZWxkLmtleV0gPSBudWxsO1xuICAgIH1cbiAgfVxufVxuIl19